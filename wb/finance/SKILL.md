---
name: finance
description: –ú–æ–¥—É–ª—å —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –¥–ª—è –ø—Ä–æ–¥–∞–≤—Ü–∞ Wildberries. –†–∞–∑–±–∏—Ä–∞–µ—Ç –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç –æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, —Å—á–∏—Ç–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—É—é –º–∞—Ä–∂—É, –≤—ã—è–≤–ª—è–µ—Ç —É–±—ã—Ç–æ—á–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –¥–∞–π–¥–∂–µ—Å—Ç –≤ Telegram.
---

## –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –º–æ–¥—É–ª—å

### üí∞ –†–∞–∑–±–æ—Ä –æ—Ç—á—ë—Ç–∞ –æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
–û—Ç—á—ë—Ç –æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ ‚Äî –≥–ª–∞–≤–Ω—ã–π —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –ø—Ä–æ–¥–∞–≤—Ü–∞ –Ω–∞ WB.
–û–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ —É–¥–µ—Ä–∂–∞–Ω–∏—è, –∫–æ–º–∏—Å—Å–∏–∏, –ª–æ–≥–∏—Å—Ç–∏–∫—É –∏ –≤—ã–ø–ª–∞—Ç—ã –∑–∞ –ø–µ—Ä–∏–æ–¥.

–ú–æ–¥—É–ª—å:
- –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç—á—ë—Ç —á–µ—Ä–µ–∑ `GET /api/v5/supplier/reportDetailByPeriod`;
- —Å—á–∏—Ç–∞–µ—Ç **—Ä–µ–∞–ª—å–Ω—É—é –≤—ã—Ä—É—á–∫—É** (–ø–æ—Å–ª–µ –≤—Å–µ—Ö –≤—ã—á–µ—Ç–æ–≤ WB);
- —Å—á–∏—Ç–∞–µ—Ç **–º–∞—Ä–∂—É** –ø–æ –∫–∞–∂–¥–æ–º—É SKU;
- –≤—ã—è–≤–ª—è–µ—Ç **—É–±—ã—Ç–æ—á–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏** ‚Äî —Ç–æ–≤–∞—Ä—ã, –≥–¥–µ –ª–æ–≥–∏—Å—Ç–∏–∫–∞ + –∫–æ–º–∏—Å—Å–∏—è > –≤—ã—Ä—É—á–∫–∏;
- —Å—á–∏—Ç–∞–µ—Ç **–∏—Ç–æ–≥–æ–≤—É—é —Å—É–º–º—É –∫ –≤—ã–ø–ª–∞—Ç–µ** –∑–∞ –ø–µ—Ä–∏–æ–¥;
- –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç —Ä–∞—Å—Ö–æ–¥—ã: –∫–æ–º–∏—Å—Å–∏—è, –ª–æ–≥–∏—Å—Ç–∏–∫–∞, —Ö—Ä–∞–Ω–µ–Ω–∏–µ, —à—Ç—Ä–∞—Ñ—ã, —Ä–µ–∫–ª–∞–º–∞.

### üì¨ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –¥–∞–π–¥–∂–µ—Å—Ç –≤ Telegram
–ö–∞–∂–¥–æ–µ —É—Ç—Ä–æ –ø—Ä–æ–¥–∞–≤–µ—Ü –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–ª—é—á–µ–≤—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏ –∑–∞ –≤—á–µ—Ä–∞:

```
üì¶ –î–∞–π–¥–∂–µ—Å—Ç –∑–∞ 26.02.2025

üí∞ –í—ã—Ä—É—á–∫–∞:         45 200 ‚ÇΩ
üìâ –í—ã—á–µ—Ç—ã WB:       12 300 ‚ÇΩ
‚úÖ –ß–∏—Å—Ç—ã–º–∏:         32 900 ‚ÇΩ
üìä –ú–∞—Ä–∂–∞:           72.8%

üõí –ó–∞–∫–∞–∑–æ–≤:         38
‚Ü©Ô∏è –í–æ–∑–≤—Ä–∞—Ç–æ–≤:       3
üì¶ –¢–æ–ø-—Ç–æ–≤–∞—Ä:       –ê—Ä—Ç–∏–∫—É–ª 12345678

‚ö†Ô∏è –£–±—ã—Ç–æ—á–Ω—ã—Ö SKU:   2  ‚Üí —Å–º. –¥–µ—Ç–∞–ª–∏
üî¥ –î–µ—Ñ–∏—Ü–∏—Ç:         SKU 87654321
```

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –û—Ç—á—ë—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (WB API)
–ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –æ—Ç—á—ë—Ç–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç:
- `realizationreport_id` ‚Äî ID –æ—Ç—á—ë—Ç–∞
- `nm_id` ‚Äî –∞—Ä—Ç–∏–∫—É–ª WB
- `retail_price` ‚Äî —Ü–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏
- `ppvz_for_pay` ‚Äî —Å—É–º–º–∞ –∫ –≤—ã–ø–ª–∞—Ç–µ –ø—Ä–æ–¥–∞–≤—Ü—É –ø–æ –¥–∞–Ω–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏
- `delivery_rub` ‚Äî —Å—Ç–æ–∏–º–æ—Å—Ç—å –ª–æ–≥–∏—Å—Ç–∏–∫–∏
- `storage_fee` ‚Äî —Ö—Ä–∞–Ω–µ–Ω–∏–µ
- `penalty` ‚Äî —à—Ç—Ä–∞—Ñ—ã
- `supplier_oper_name` ‚Äî —Ç–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏ (–ø—Ä–æ–¥–∞–∂–∞ / –≤–æ–∑–≤—Ä–∞—Ç / —à—Ç—Ä–∞—Ñ)

### –ò—Ç–æ–≥–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏
```python
{
  "period": {"from": "2025-02-17", "to": "2025-02-23"},
  "gross_revenue": 85000.0,       # –≤—ã—Ä—É—á–∫–∞ –¥–æ –≤—ã—á–µ—Ç–æ–≤
  "total_deductions": 22000.0,    # –≤—Å–µ –≤—ã—á–µ—Ç—ã WB
  "net_revenue": 63000.0,         # —á–∏—Å—Ç–∞—è –≤—ã—Ä—É—á–∫–∞
  "margin_pct": 74.1,             # –º–∞—Ä–∂–∞ %
  "to_pay": 63000.0,              # —Å—É–º–º–∞ –∫ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—é
  "deductions_breakdown": {
      "commission": 12000.0,
      "logistics": 7000.0,
      "storage": 1500.0,
      "penalties": 500.0,
      "advertising": 1000.0
  },
  "by_sku": {
      123456: {"revenue": 5000, "cost": 1200, "margin_pct": 76.0, "is_loss": false}
  },
  "loss_skus": [789012, 345678],
  "orders": 120,
  "returns": 8
}
```

---

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.10+
- `requests` –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
- WB API-—Ç–æ–∫–µ–Ω —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ —Ä–∞–∑–¥–µ–ª—É **–§–∏–Ω–∞–Ω—Å—ã** (–∫–∞—Ç–µ–≥–æ—Ä–∏—è —Ç–æ–∫–µ–Ω–∞: `–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞`)
- Telegram Bot Token + Chat ID –¥–ª—è –¥–∞–π–¥–∂–µ—Å—Ç–∞

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```json
{
  "wb": {
    "enabled": true,
    "WB_API_TOKEN": {
      "apiKey": "YOUR_WB_TOKEN"
    }
  },
  "telegram": {
    "botToken": "YOUR_BOT_TOKEN",
    "chatId": "YOUR_CHAT_ID"
  },
  "finance": {
    "digest_hour": 9,
    "loss_margin_threshold": 0,
    "low_margin_threshold": 20
  }
}
```

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|---|---|---|
| `digest_hour` | –ß–∞—Å –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–π–¥–∂–µ—Å—Ç–∞ (UTC) | 9 |
| `loss_margin_threshold` | –ù–∏–∂–µ —ç—Ç–æ–π –º–∞—Ä–∂–∏ SKU —Å—á–∏—Ç–∞–µ—Ç—Å—è —É–±—ã—Ç–æ—á–Ω—ã–º (%) | 0 |
| `low_margin_threshold` | –ù–∏–∂–µ —ç—Ç–æ–π –º–∞—Ä–∂–∏ SKU —Å—á–∏—Ç–∞–µ—Ç—Å—è –Ω–∏–∑–∫–æ–º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω—ã–º (%) | 20 |

---

## API Wildberries

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|---|---|---|
| GET | `/api/v5/supplier/reportDetailByPeriod` | –î–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç –æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ |

**–í–∞–∂–Ω–æ:**
- –û—Ç—á—ë—Ç —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∑–∞ **–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ –Ω–µ–¥–µ–ª–∏** (–ø–Ω‚Äì–≤—Å).
- –î–∞–Ω–Ω—ã–µ –∑–∞ —Ç–µ–∫—É—â—É—é –Ω–µ–∑–∞–∫—Ä—ã—Ç—É—é –Ω–µ–¥–µ–ª—é –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã.
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è —á–µ—Ä–µ–∑ `rrdid` (ID –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç—Ä–æ–∫–∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –æ—Ç–≤–µ—Ç–∞).
- –õ–∏–º–∏—Ç: 100 000 —Å—Ç—Ä–æ–∫ –∑–∞ –∑–∞–ø—Ä–æ—Å.

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
wb/
‚îî‚îÄ‚îÄ finance/
    ‚îú‚îÄ‚îÄ SKILL.md       ‚Üê —ç—Ç–æ—Ç —Ñ–∞–π–ª
    ‚îî‚îÄ‚îÄ script.py      ‚Üê –≤—Å—è –ª–æ–≥–∏–∫–∞ –º–æ–¥—É–ª—è
```

---

## –ö–∞–∫ –≤—ã–∑—ã–≤–∞—Ç—å

```python
from wb.finance.script import process as process_finance

# –†–∞–∑–±–æ—Ä –æ—Ç—á—ë—Ç–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥
result = process_finance(config, date_from="2025-02-17", date_to="2025-02-23")

# –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –¥–∞–π–¥–∂–µ—Å—Ç (–±–µ—Ä—ë—Ç –¥–∞–Ω–Ω—ã–µ –∑–∞ –≤—á–µ—Ä–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
from wb.finance.script import send_daily_digest
send_daily_digest(config)
```

---

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å main.py

```python
from wb.finance.script import process as process_finance
from wb.finance.script import send_daily_digest

# –≤ run_wb_skill():
results["finance"] = process_finance(config, date_from, date_to)

# –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫—Ä–æ–Ω –Ω–∞ —É—Ç—Ä–æ:
send_daily_digest(config)
```

---

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è
- –£–±—ã—Ç–æ—á–Ω—ã–µ SKU –Ω–µ –æ–∑–Ω–∞—á–∞—é—Ç —É–±—ã—Ç–æ–∫ –Ω–∞ –≤—Å—ë–º –±–∏–∑–Ω–µ—Å–µ ‚Äî –≤–æ–∑–º–æ–∂–Ω–æ, —ç—Ç–æ –∞–∫—Ü–∏–æ–Ω–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏.
- –ú–∞—Ä–∂–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è –∫–∞–∫ `(net_revenue / gross_revenue) * 100`.
- –®—Ç—Ä–∞—Ñ—ã WB –≤—ã–¥–µ–ª—è—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è ‚Äî –æ–Ω–∏ —á–∞—Å—Ç–æ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã.
- –î–∞–π–¥–∂–µ—Å—Ç –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ –∫—Ä–∞—Ç–∫–∏–π: —Ç–æ–ª—å–∫–æ —Ñ–ª–∞–≥–∏ –∏ –∫–ª—é—á–µ–≤—ã–µ —á–∏—Å–ª–∞, –±–µ–∑ —Ç–∞–±–ª–∏—Ü.